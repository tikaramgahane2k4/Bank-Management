{% extends "base.html" %}
{% block content %}

<div class="flex flex-col gap-10 animate-up">
    <!-- Admin Header -->
    <div
        class="flex flex-col md:flex-row justify-between items-start md:items-center bg-white p-8 rounded-2xl border border-slate-100 shadow-sm gap-6">
        <div>
            <span
                class="px-3 py-1 rounded-full bg-rose-50 text-rose-600 text-[10px] font-black uppercase tracking-widest mb-4 inline-block">System
                Administrator</span>
            <h1 class="font-black text-slate-900 tracking-tighter" style="font-size: var(--h2);">Account Management</h1>
            <p class="text-slate-500 font-medium text-sm">Reviewing and configuring {{ accounts|length }} bank assets
            </p>
        </div>
        <div class="flex gap-4">
            <div class="card p-4 flex flex-col items-center justify-center min-w-[120px] shadow-sm">
                <div class="text-[10px] font-black text-slate-400 uppercase mb-1">Total Assets</div>
                <div class="text-xl font-black text-slate-900">${{ "%.0f"|format(accounts|sum(attribute='balance')) }}
                </div>
            </div>
        </div>
    </div>

    <!-- Accounts Table/Grid -->
    <div class="grid grid-cols-auto gap-6">
        {% for a in accounts %}
        <div class="card p-6 flex flex-col hover:border-blue-200">
            <div class="flex justify-between items-start mb-6">
                <div class="flex items-center gap-3">
                    <span class="text-lg font-black text-slate-900 font-mono">#{{ a.account_number }}</span>
                    <span
                        class="px-2 py-xs rounded-full text-[10px] font-black uppercase tracking-wider {% if a.status == 'active' %} bg-emerald-100 text-emerald-700 {% else %} bg-rose-100 text-rose-700 {% endif %}">
                        {{ a.status }}
                    </span>
                </div>
                <div class="text-[10px] font-black text-slate-400">{{ a.account_type }}</div>
            </div>

            <div class="mb-6">
                <div class="text-[10px] font-black text-slate-400 uppercase mb-1">Primary Owner</div>
                <div class="font-bold text-slate-800">{{ a.user.name or 'N/A' }}</div>
                <div class="text-xs text-slate-500">{{ a.user.email }}</div>
            </div>

            <div class="mb-8 mt-auto">
                <div class="text-[10px] font-black text-slate-400 uppercase mb-1">Current Balance</div>
                <div class="text-2xl font-black text-slate-900 tracking-tight">${{ "%.2f"|format(a.balance) }}</div>
            </div>

            <div class="flex gap-3 pt-6 border-t border-slate-50">
                <a href="{{ url_for('admin_edit_account', account_number=a.account_number) }}"
                    class="btn btn-secondary flex-1 py-2 text-xs font-black">Configure</a>
                <form action="{{ url_for('admin_delete_account') }}" method="POST" class="flex-1"
                    onsubmit="return confirm('Securely terminate this account? This action cannot be undone.')">
                    <input type="hidden" name="account_number" value="{{ a.account_number }}">
                    <button type="submit"
                        class="btn w-full py-2 text-xs font-black bg-rose-50 text-rose-600 hover:bg-rose-100 transition-all">Terminate</button>
                </form>
            </div>
        </div>
        {% endfor %}

        {% if not accounts %}
        <div class="card p-12 text-center bg-slate-50 border-2 border-dashed border-slate-200"
            style="grid-column: 1 / -1;">
            <div class="text-4xl mb-4">üå´Ô∏è</div>
            <p class="text-slate-500 font-bold">No registered accounts found in the database.</p>
        </div>
        {% endif %}
    </div>
</div>

{% endblock %}